<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ALS MLS and TLS forest plot alignment • lidRalignment</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="ALS MLS and TLS forest plot alignment">
<meta property="og:description" content="Alignment of forest plots point clouds (ALS, ULS, MLS, TLS), including complex cases with significant misalignments.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lidRalignment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/internal.html">Description of the internal pipeline</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="lidralignment">lidRalignment<a class="anchor" aria-label="anchor" href="#lidralignment"></a>
</h1></div>
<p><img src="https://img.shields.io/badge/Licence-GPL--3-blue.svg" alt="license"><img src="https://img.shields.io/badge/Lifecycle-Maturing-997722" alt="Lifecycle:Experimental"></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><code>lidRalignment</code> is an extension package for <code>lidR</code> that enables automatic alignment of forest plot point clouds from different sources, such as ALS with TLS or MLS, or TLS with MLS. The package is robust to large alignment differences (e.g., 180 degrees of misalignment) and supports multiple feature extraction strategies to align airborne with ground data or ground with ground data.</p>
<p><img src="./reference/figures/alignement1.jpg"><strong>Figure 1</strong> – The alignment of ALS (red) and MLS (yellow) point clouds is achieved by aligning the CHMs and DTMs, recording the transformation matrix, and applying it to the entire MLS point cloud.</p>
<p><img src="./reference/figures/alignement2.jpg"><strong>Figure 2</strong> – The alignment of MLS (red) and TLS (yellow) point clouds is refined by extracting and aligning isotropic features (most likely the main trunks), recording the transformation matrix, and applying it to the entire TLS point cloud.</p>
</div>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>Aligns forest plots from different sources, such as ALS with TLS or MLS, or TLS with MLS.</li>
<li>Is robust to large alignment differences (e.g., 180 degrees of misalignment).</li>
<li>Supports extremely noisy and poor-quality data.</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You need the latest version of <code>lidR</code> and <code>lasR</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lidR'</span>, <span class="st">'lasR'</span>, <span class="st">'lidRalignment'</span><span class="op">)</span>, repos <span class="op">=</span> <span class="st">'https://r-lidar.r-universe.dev'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<p>The alignment pipeline consists of four stages, progressing from raw to extra fine:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Raw:</strong> Roughly aligns the plot centers.</li>
<li>
<strong>Coarse</strong>: Uses the DTM and CHM to align the point clouds at low resolution. This stage can handle highly misaligned scenes.</li>
<li>
<strong>Fine</strong>: Applies an iterative closest point (ICP) approach to finely align the CHM and DTM.</li>
<li>
<strong>Extra Fine</strong>: Used only when aligning two ground-based point clouds. It extracts trees and aligns them to achieve centimeter-level accuracy.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lidar/lidR" class="external-link">lidR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lidRalignment</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fref</span> <span class="op">=</span> <span class="st">"als_file.las"</span></span>
<span><span class="va">fmov</span> <span class="op">=</span> <span class="st">"mls_file.las"</span></span>
<span></span>
<span><span class="co"># Setup the pipeline. It is important to tell the object</span></span>
<span><span class="co"># what we are aligning in order to perform or not</span></span>
<span><span class="co"># the last extra fine alignment</span></span>
<span><span class="va">alignment</span> <span class="op">=</span> <span class="va"><a href="reference/AlignmentScene.html">AlignmentScene</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fref</span>, <span class="va">fmov</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">set_ref_is_ground_based</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">set_mov_is_ground_based</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the alignment pipeline</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">align</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the different level of alignment</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"coarse"</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"fine"</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"extra"</span>, compare_to <span class="op">=</span> <span class="st">"fine"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the final transformation matrix to register the entire point cloud.</span></span>
<span><span class="va">M</span> <span class="op">=</span> <span class="va">alignment</span><span class="op">$</span><span class="fu">get_registration_matrix</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">crs</span> <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lidR/man/readLASheader.html" class="external-link">readLASheader</a></span><span class="op">(</span><span class="va">fref</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ofile</span> <span class="op">=</span> <span class="fu"><a href="reference/transform_las.html">transform_las</a></span><span class="op">(</span><span class="va">fmov</span>, <span class="va">M</span>, <span class="va">crs</span><span class="op">)</span></span></code></pre></div>
<p>Rather than running the full alignment pipeline, it is possible to run it step by step.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alignment</span> <span class="op">=</span> <span class="va"><a href="reference/AlignmentScene.html">AlignmentScene</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fref</span>, <span class="va">fmov</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">set_ref_is_ground_based</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">set_mov_is_ground_based</span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">prepare</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"raw"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">coarse_align</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"coarse"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">fine_align</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"fine"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">extra_fine_align</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">alignment</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="st">"extra"</span>, compare_to <span class="op">=</span> <span class="st">"fine"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sponsor">Sponsor<a class="anchor" aria-label="anchor" href="#sponsor"></a>
</h2>
<p><code>lidRalignment</code> has been sponsored by the <a href="https://www.usherbrooke.ca/" class="external-link">University of Sherbrooke</a></p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/23/Universit%C3%A9_de_Sherbrooke_%28logo%29_%282%29.svg/langfr-1920px-Universit%C3%A9_de_Sherbrooke_%28logo%29_%282%29.svg.png" alt="Description" width="400"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lidRalignment</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jean-Romain Roussel <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Jean-Romain Roussel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
